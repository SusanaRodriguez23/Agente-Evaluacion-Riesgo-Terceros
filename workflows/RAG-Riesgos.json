{
  "name": "RAG-Riesgos",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -432,
        -16
      ],
      "id": "80a4c5a1-2b7c-40d2-a042-025a31552595",
      "name": "When clicking ‘Execute workflow’"
    },
    {
      "parameters": {
        "mode": "insert",
        "memoryKey": {
          "__rl": true,
          "value": "Key_certificados",
          "mode": "list",
          "cachedResultName": "Key_certificados"
        },
        "clearStore": true
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
      "typeVersion": 1.3,
      "position": [
        -16,
        -16
      ],
      "id": "9b1b1a71-72a7-43cd-ba79-07fcc9dac485",
      "name": "Simple Vector Store"
    },
    {
      "parameters": {
        "model": "llama3.2:3b"
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOllama",
      "typeVersion": 1,
      "position": [
        -112,
        160
      ],
      "id": "c18dee22-05ea-47b4-a464-fb8074a9e7a1",
      "name": "Embeddings Ollama",
      "credentials": {
        "ollamaApi": {
          "id": "aeCL7nnKz9o97s8N",
          "name": "Ollama account 2"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1.1,
      "position": [
        96,
        144
      ],
      "id": "0c48a822-a61b-4f5c-a2fe-256226f4acf8",
      "name": "Default Data Loader"
    },
    {
      "parameters": {
        "jsCode": "// Base de conocimiento RAG\nconst fragmentos = [\n  {\n    id: \"doc_1\",\n    text: \"Matriz de Riesgo: alto riesgo cuando el proveedor almacena datos PII fuera de la UE.\"\n  },\n  {\n    id: \"doc_2\",\n    text: \"El riesgo se determina por acceso a datos sensibles, ubicación geográfica y controles de seguridad.\"\n  },\n  {\n    id: \"doc_3\",\n    text: \"Almacenar PII dentro de la UE con cifrado y certificaciones reduce el riesgo.\"\n  },\n  {\n    id: \"doc_4\",\n    text: \"Riesgo medio: PII dentro de la UE pero con controles insuficientes o sin auditorías vigentes.\"\n  },\n  {\n    id: \"doc_5\",\n    text: \"Riesgo bajo: cifrado fuerte, certificaciones activas y ubicación dentro de la UE.\"\n  },\n  {\n    id: \"doc_6\",\n    text: \"Transferencias internacionales requieren cláusulas contractuales estándar y evaluación adicional.\"\n  },\n  {\n    id: \"doc_7\",\n    text: \"Acceso o transmisión de datos PII en tránsito sin cifrado fuerte puede considerarse riesgo alto.\"\n  },\n  {\n    id: \"doc_8\",\n    text: \"Cifrado TLS 1.2 o superior, VPN corporativa y protección contra interceptación reducen el riesgo de transmisión.\"\n  },\n  {\n    id: \"doc_9\",\n    text: \"Riesgo alto en datos en tránsito si los paquetes cruzan fronteras fuera de la UE sin cláusulas contractuales y acuerdos de protección de datos.\"\n  },\n  {\n    id: \"doc_10\",\n    text: \"Riesgo medio si hay cifrado pero no existen auditorías recientes, registros de acceso o monitoreo de integridad.\"\n  },\n  {\n    id: \"doc_11\",\n    text: \"Riesgo bajo si la transmisión se realiza dentro de la UE con cifrado fuerte, autenticación robusta, monitoreo activo y contrato de tratamiento de datos firmado.\"\n  },\n  {\n    id: \"doc_12\",\n    text: \"PII en tránsito debe estar protegida contra ataques como MITM, sniffing, interceptación, replay y desvío de tráfico.\"\n  },\n  {\n    id: \"doc_13\",\n    text: \"Buenas prácticas recomiendan rotar claves criptográficas periódicamente y aplicar HSTS para evitar degradación a tráfico sin cifrar.\"\n  },\n  {\n    id: \"doc_14\",\n    text: \"El proveedor debe demostrar evidencia de que el cifrado en tránsito es efectivo: políticas de cifrado, auditorías, pruebas de penetración y reportes de seguridad.\"\n  }\n];\n\nreturn fragmentos.map(f => ({ json: f }));\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -224,
        -16
      ],
      "id": "497056f5-a2a0-48f5-9855-b0e4b1fa9595",
      "name": "RAG"
    }
  ],
  "pinData": {},
  "connections": {
    "When clicking ‘Execute workflow’": {
      "main": [
        [
          {
            "node": "RAG",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings Ollama": {
      "ai_embedding": [
        [
          {
            "node": "Simple Vector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader": {
      "ai_document": [
        [
          {
            "node": "Simple Vector Store",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "RAG": {
      "main": [
        [
          {
            "node": "Simple Vector Store",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "46c59f79-00a2-453c-9fca-1fe2476cacbb",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "2ab2eedd701691bc9deb393150d0f34cdb4a895536b6bb6297c19755623506a6"
  },
  "id": "gBDc0Nz74E2VGI90",
  "tags": []
}